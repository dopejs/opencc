<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenCC</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-brand">
        <svg class="brand-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        <div>
          <span class="brand-name">OpenCC</span>
          <span class="brand-version" id="version"></span>
        </div>
      </div>
      <nav class="sidebar-nav">
        <button class="nav-item active" data-tab="providers">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="8" rx="2"/><rect x="2" y="14" width="20" height="8" rx="2"/><circle cx="6" cy="6" r="1"/><circle cx="6" cy="18" r="1"/></svg>
          <span>Providers</span>
        </button>
        <button class="nav-item" data-tab="profiles">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
          <span>Profiles</span>
        </button>
        <button class="nav-item" data-tab="logs">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
          <span>Logs</span>
        </button>
        <button class="nav-item" data-tab="settings">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          <span>Settings</span>
        </button>
      </nav>
      <div class="sidebar-footer">
        <button class="nav-item nav-reload" id="btn-reload">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
          <span>Reload Config</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="main">
      <!-- Providers Tab -->
      <section id="tab-providers" class="tab-content active">
        <div class="page-header">
          <div>
            <h1>Providers</h1>
            <p class="page-desc">Manage your API provider configurations</p>
          </div>
          <button class="btn btn-primary" id="btn-add-provider">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add Provider
          </button>
        </div>
        <div id="providers-list"></div>
      </section>

      <!-- Profiles Tab -->
      <section id="tab-profiles" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Profiles</h1>
            <p class="page-desc">Manage provider groups and fallback order</p>
          </div>
          <button class="btn btn-primary" id="btn-add-profile">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add Profile
          </button>
        </div>
        <div id="profiles-list"></div>
      </section>

      <!-- Profile Edit Page -->
      <section id="tab-profile-edit" class="tab-content">
        <div class="page-header">
          <div>
            <h1 id="pe-title">Edit Profile</h1>
            <p class="page-desc" id="pe-desc"></p>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost" id="pe-cancel">Cancel</button>
            <button class="btn btn-primary" id="pe-save">Save</button>
          </div>
        </div>
        <form id="pe-form">
          <div class="form-group" id="pe-name-group">
            <label for="pe-name">Name</label>
            <input type="text" id="pe-name" required autocomplete="off" placeholder="my-profile">
          </div>
          <div class="form-group">
            <label>Providers <span class="label-hint">(drag handle or arrows to reorder)</span></label>
            <div id="pe-providers" class="provider-selector"></div>
          </div>
          <div class="form-divider"><span>Scenario Routing (Optional)</span></div>
          <div id="pe-routing" class="routing-section"></div>
        </form>
      </section>

      <!-- Logs Tab -->
      <section id="tab-logs" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Logs</h1>
            <p class="page-desc">View proxy request logs and errors</p>
          </div>
          <button class="btn btn-ghost" id="btn-refresh-logs">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
            Refresh
          </button>
        </div>
        <div class="logs-filters">
          <div class="filter-group">
            <label>Provider</label>
            <select id="logs-provider-filter">
              <option value="">All Providers</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Log Type</label>
            <select id="logs-type-filter">
              <option value="">All Logs</option>
              <option value="errors">Errors Only</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Status Code</label>
            <select id="logs-status-filter">
              <option value="">All Status</option>
              <option value="4xx">4xx (Client Errors)</option>
              <option value="5xx">5xx (Server Errors)</option>
              <option value="401">401 (Unauthorized)</option>
              <option value="403">403 (Forbidden)</option>
              <option value="429">429 (Rate Limited)</option>
              <option value="500">500 (Server Error)</option>
              <option value="502">502 (Bad Gateway)</option>
              <option value="529">529 (Overloaded)</option>
            </select>
          </div>
        </div>
        <div id="logs-list" class="logs-container"></div>
      </section>

      <!-- Settings Tab -->
      <section id="tab-settings" class="tab-content">
        <div class="page-header">
          <div>
            <h1>Settings</h1>
            <p class="page-desc">Configure global settings</p>
          </div>
          <button class="btn btn-primary" id="btn-save-settings">Save Settings</button>
        </div>
        <form id="settings-form">
          <div class="form-group">
            <label for="settings-default-cli">Default CLI</label>
            <select id="settings-default-cli">
              <option value="claude">Claude Code</option>
              <option value="codex">Codex</option>
              <option value="opencode">OpenCode</option>
            </select>
          </div>
          <div class="form-group">
            <label for="settings-default-profile">Default Profile</label>
            <select id="settings-default-profile"></select>
          </div>
          <div class="form-group">
            <label for="settings-web-port">Web UI Port</label>
            <input type="number" id="settings-web-port" min="1024" max="65535" placeholder="19840">
            <p class="form-hint">Changes require restart of the web server</p>
          </div>
        </form>
      </section>
    </div>
  </div>

  <!-- Provider Modal -->
  <div id="provider-modal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2 id="provider-modal-title">Add Provider</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <form id="provider-form" class="modal-body">
        <div class="form-group">
          <label for="pf-name">Name</label>
          <input type="text" id="pf-name" required autocomplete="off" placeholder="my-provider">
        </div>
        <div class="form-group">
          <label for="pf-type">API Type</label>
          <select id="pf-type">
            <option value="anthropic">Anthropic Messages API</option>
            <option value="openai">OpenAI Chat Completions API</option>
          </select>
        </div>
        <div class="form-group">
          <label for="pf-base-url">Base URL</label>
          <input type="url" id="pf-base-url" required placeholder="https://api.example.com">
        </div>
        <div class="form-group">
          <label for="pf-token">Auth Token</label>
          <input type="text" id="pf-token" autocomplete="off" placeholder="sk-...">
        </div>
        <div class="form-divider"><span>Model Overrides</span></div>
        <div class="form-row">
          <div class="form-group">
            <label for="pf-model">Default Model</label>
            <div class="ac-wrap">
              <input type="text" id="pf-model" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-default">
            </div>
          </div>
          <div class="form-group">
            <label for="pf-reasoning">Reasoning Model</label>
            <div class="ac-wrap">
              <input type="text" id="pf-reasoning" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-default">
            </div>
          </div>
        </div>
        <div class="form-row form-row-3">
          <div class="form-group">
            <label for="pf-haiku">Haiku</label>
            <div class="ac-wrap">
              <input type="text" id="pf-haiku" placeholder="claude-haiku-4-5" autocomplete="off" data-ac="models-haiku">
            </div>
          </div>
          <div class="form-group">
            <label for="pf-opus">Opus</label>
            <div class="ac-wrap">
              <input type="text" id="pf-opus" placeholder="claude-opus-4-5" autocomplete="off" data-ac="models-opus">
            </div>
          </div>
          <div class="form-group">
            <label for="pf-sonnet">Sonnet</label>
            <div class="ac-wrap">
              <input type="text" id="pf-sonnet" placeholder="claude-sonnet-4-5" autocomplete="off" data-ac="models-sonnet">
            </div>
          </div>
        </div>
        <div class="form-divider"><span>Environment Variables (Optional)</span></div>
        <details class="env-vars-section" open>
          <summary>Custom Environment Variables</summary>
          <div>
            <p class="env-hint">Add environment variables that will be set when using this provider. Common examples:</p>
            <div class="env-presets">
              <button type="button" class="btn-preset" data-env="CLAUDE_CODE_MAX_OUTPUT_TOKENS" data-value="64000">Max Output Tokens</button>
              <button type="button" class="btn-preset" data-env="MAX_THINKING_TOKENS" data-value="50000">Max Thinking</button>
              <button type="button" class="btn-preset" data-env="ANTHROPIC_MAX_CONTEXT_WINDOW" data-value="1000000">Max Context</button>
              <button type="button" class="btn-preset" data-env="CLAUDE_CODE_EFFORT_LEVEL" data-value="high">Effort Level</button>
              <button type="button" class="btn-preset" data-env="BASH_DEFAULT_TIMEOUT_MS" data-value="180000">Bash Timeout</button>
            </div>
            <div id="env-vars-list"></div>
            <button type="button" class="btn btn-ghost btn-sm" id="btn-add-env">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Variable
            </button>
          </div>
        </details>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost modal-cancel">Cancel</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div id="confirm-modal" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2>Confirm Delete</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="confirm-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
        </div>
        <p id="confirm-message"></p>
        <div class="modal-footer">
          <button class="btn btn-ghost modal-cancel" id="confirm-cancel">Cancel</button>
          <button class="btn btn-danger" id="confirm-ok">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add to Profiles Modal -->
  <div id="add-to-profiles-modal" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h2>Add to Profiles</h2>
        <button class="btn-close modal-close" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="add-profiles-desc">Select profiles to add this provider to:</p>
        <div id="atp-profiles" class="profile-checklist"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" id="atp-skip">Skip</button>
          <button type="button" class="btn btn-primary" id="atp-confirm">Add</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast container -->
  <div id="toast-container"></div>

  <script src="app.js"></script>
</body>
</html>
